from morph_tri import *
from click_correspondences import *
import imageio




sourceImage = np.array(Image.open("cat.jpeg"))
destImage = np.array(Image.open("tiger.png"))

#sourceImage = np.array(Image.open("leo.jpg"))
#destImage = np.array(Image.open("sachin.png"))



sourcePoints, destinationPoints = click_correspondences(sourceImage, destImage)

## 

#ex1
'''
sourcePoints = np.array([[ 73.34256952 ,  8.7195157 ],
 [107.2168735,   27.77381168],
 [136.85688947,  16.12951969],
 [164.37976145,  35.18381568],
 [209.89835742,  21.95166569],
 [194.01977743,  70.11669165],
 [188.72691743, 103.99099562],
 [162.79190345, 133.1017256 ],
 [126.27116948, 143.68744559],
 [ 91.33829351, 133.1017256 ],
 [ 70.69613953,  99.22742163],
 [ 68.57899553,  64.29454565],
 [ 97.16043951,  80.17312564],
 [116.74402149,  83.87812764],
 [115.15616349, 100.28599363],
 [ 96.63115351,  99.22742163],
 [144.26689347,  87.05384364],
 [160.67475945,  88.11241563],
 [162.26261745, 100.81527962],
 [144.26689347, 103.99099562],
 [118.33187949, 119.34028961],
 [132.62260148, 119.34028961],
 [  0.     ,      0.        ],
 [256.     ,    256.        ],
 [256.     ,      0.        ],
 [  0.     ,   256.        ]]
)



destinationPoints = np.array([[ 47.7227213,    9.2488017 ],
 [ 95.35846126,  36.77167368],
 [137.70134123,  35.71310168],
 [194.33494318,  48.41596567],
 [232.97282115,  27.24452568],
 [204.39137717,  80.17312564],
 [222.38710116, 119.86957561],
 [210.21352317, 175.97389156],
 [116.00061524, 228.90249152],
 [ 41.3712893 , 191.32318555],
 [ 22.84627932, 139.98244359],
 [ 40.8420033 ,  84.40741364],
 [ 80.00916727,  96.58099163],
 [103.29775126,  97.11027763],
 [ 95.88774726, 121.98671961],
 [ 76.83345128, 111.93028562],
 [156.75563721, 100.28599363],
 [178.98564919, 104.52028162],
 [176.8685052 , 118.28171761],
 [158.34349521, 121.45743361],
 [ 99.59274926, 165.38817157],
 [138.23062723, 168.56388757],
 [  0.      ,     0.        ],
 [256.      ,   256.        ],
 [256.      ,     0.        ],
 [  0.      ,   256.        ]])

'''

'''

sourcePoints = np.array ([[120.22083907, 178.34197527],
 [123.39655507, 122.23765931],
 [144.56799505,  53.43047937],
 [194.32087901,  19.55617539],
 [252.54233896,   7.9118834 ],
 [308.64665492,  23.79046339],
 [348.87239089,  39.66904338],
 [392.27384285, 108.47622332],
 [393.33241485, 188.92769526],
 [140.33370705, 276.78917119],
 [161.50514704, 327.60062715],
 [195.37945101 ,365.70921912],
 [252.54233896, 397.46637909],
 [306.52951092, 374.17779511],
 [349.93096289, 333.95205914],
 [375.33669087, 274.67202719],
 [119.16226707, 229.15343123],
 [383.80526686, 231.27057523],
 [154.09514304, 211.15770724],
 [197.49659501, 181.51769127],
 [239.83947497, 209.04056324],
 [272.65520695, 211.15770724],
 [318.17380291, 183.63483526],
 [354.16525088, 214.33342324],
 [172.09086703, 231.27057523],
 [209.140887  , 242.91486722],
 [292.76807493 ,236.56343522],
 [324.52523491, 240.79772322],
 [219.72660699, 265.1448792 ],
 [199.61373901, 289.49203518],
 [191.14516301 ,319.13205116],
 [293.82664693, 267.2620232 ],
 [317.11523091, 286.31631918],
 [322.40809091, 319.13205116],
 [215.49231899 ,315.95633516],
 [259.95234296 ,308.54633116],
 [295.94379093, 317.01490716],
 [255.71805496, 342.42063514],
 [  0.        ,   0.        ],
 [512.        , 512.        ],
 [512.        ,   0.        ],
 [  0.        , 512.        ]])

destinationPoints = np.array([[111.32402259, 227.03628723],
 [ 98.6211586,  141.2919553 ],
 [121.90974258,  75.66049135],
 [171.66262654 , 17.4390314 ],
 [249.99695448 ,  2.61902341],
 [328.33128241 , 17.4390314 ],
 [379.14273837 , 60.84048336],
 [411.95847035 ,127.53051931],
 [407.72418235 ,220.68485523],
 [138.84689456, 364.65064712],
 [164.25262254, 404.87638309],
 [207.65407451, 438.75068706],
 [270.10982246, 458.86355504],
 [336.79985841, 435.57497106],
 [374.90845038, 397.46637909],
 [395.02131836, 351.94778313],
 [ 97.5625866 , 301.13632717],
 [410.89989835, 288.43346318],
 [153.66690255, 247.14915521],
 [204.47835851, 214.33342324],
 [258.46553047, 248.20772721],
 [291.28126244, 250.32487121],
 [330.44842641, 210.09913524],
 [370.67416238, 240.79772322],
 [182.24834653, 274.67202719],
 [225.64979849, 276.78917119],
 [313.51127442, 276.78917119],
 [354.79558239, 271.49631119],
 [218.2397945 , 328.65919915],
 [200.24407052, 361.47493112],
 [194.95121052, 390.0563751 ],
 [328.33128241, 327.60062715],
 [349.5027224 , 342.42063514],
 [354.79558239, 362.53350312],
 [229.88408649, 376.29493911],
 [275.40268246, 367.82636312],
 [323.03842242, 371.00207911],
 [282.81268645, 398.52495109],
 [  0.        ,   0.        ],
 [512.        , 512.        ],
 [512.        ,   0.        ],
 [  0.        , 512.        ]])

'''

print(sourcePoints)
print(destinationPoints)

w = np.arange(0, 1.1, 0.1)

morphed_set = morph_tri(sourceImage, destImage, sourcePoints, destinationPoints, w, w)
res_list = []
k = 0
while k < morphed_set.shape[0]:
	res_list.append(morphed_set[k, :, :, :])
	k += 1

imageio.mimsave('./morph_1.gif', res_list)
